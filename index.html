<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>å¹´ä»½æ›ç®—å™¨</title>
  <style>
    body {
      font-family: "Arial", sans-serif;
      padding: 20px;
    }
    input, select, button {
      font-size: 16px;
      padding: 8px;
      margin: 5px 0;
    }
    #result {
      margin-top: 20px;
      font-weight: bold;
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <h2>å¹´ä»½æ›ç®—èˆ‡ç”Ÿè‚–æŸ¥è©¢</h2>

  <label for="type">é¸æ“‡è¼¸å…¥é¡å‹ï¼š</label>
  <select id="type" onchange="toggleJapaneseInput()">
    <option value="gregorian">è¥¿å…ƒ / å…¬å…ƒ</option>
    <option value="roc">æ°‘åœ‹</option>
    <option value="japanese">æ—¥æœ¬å’Œæ›†</option>
  </select><br>

  <div id="inputArea">
    <label for="yearInput">è¼¸å…¥å¹´ä»½ï¼š</label><br>
    <input type="text" id="yearInput" placeholder="ä¾‹å¦‚ï¼š2024 æˆ– 113">
  </div>

  <div id="japaneseArea" style="display:none;">
    <label for="eraSelect">é¸æ“‡æ—¥æœ¬å¹´è™Ÿï¼š</label>
    <select id="eraSelect" onchange="updateJapaneseHint()">
      <option value="ä»¤å’Œ">ä»¤å’Œ</option>
      <option value="å¹³æˆ">å¹³æˆ</option>
      <option value="æ˜­å’Œ">æ˜­å’Œ</option>
      <option value="å¤§æ­£">å¤§æ­£</option>
      <option value="æ˜æ²»">æ˜æ²»</option>
    </select>
    <br>
    <label for="japaneseYear">è¼¸å…¥è©²å¹´è™Ÿä¸‹çš„å¹´ä»½ï¼š</label><br>
    <input type="number" id="japaneseYear" min="1">
    <span id="yearHint" style="color: gray; font-size: 14px;"></span>
  </div>

  <button onclick="convert()">æ›ç®—</button>

  <div id="result"></div>

  <script>
    const zodiac = ["é¼ ", "ç‰›", "è™", "å…”", "é¾", "è›‡", "é¦¬", "ç¾Š", "çŒ´", "é›", "ç‹—", "è±¬"];
    const japaneseEraMap = [
      { name: "ä»¤å’Œ", start: 2019, max: new Date().getFullYear() - 2019 + 1 },
      { name: "å¹³æˆ", start: 1989, max: 31 },
      { name: "æ˜­å’Œ", start: 1926, max: 64 },
      { name: "å¤§æ­£", start: 1912, max: 15 },
      { name: "æ˜æ²»", start: 1868, max: 45 }
    ];

    function toggleJapaneseInput() {
      const type = document.getElementById("type").value;
      document.getElementById("inputArea").style.display = (type === "japanese") ? "none" : "block";
      document.getElementById("japaneseArea").style.display = (type === "japanese") ? "block" : "none";
      if (type === "japanese") updateJapaneseHint();
    }

    function updateJapaneseHint() {
      const eraName = document.getElementById("eraSelect").value;
      const era = japaneseEraMap.find(e => e.name === eraName);
      const yearInput = document.getElementById("japaneseYear");
      document.getElementById("yearHint").textContent = `ï¼ˆæœ€å¤šå¯è¼¸å…¥ ${era.max} å¹´ï¼‰`;
      yearInput.max = era.max;
    }

    function convert() {
      const type = document.getElementById("type").value;
      let year = null;

      if (type === "gregorian") {
        year = parseInt(document.getElementById("yearInput").value);
      } else if (type === "roc") {
        year = parseInt(document.getElementById("yearInput").value) + 1911;
      } else if (type === "japanese") {
        const eraName = document.getElementById("eraSelect").value;
        const eraYear = parseInt(document.getElementById("japaneseYear").value);
        const era = japaneseEraMap.find(e => e.name === eraName);

        if (!eraYear || isNaN(eraYear) || eraYear < 1 || eraYear > era.max) {
          document.getElementById("result").textContent = `è«‹è¼¸å…¥æœ‰æ•ˆçš„ ${era.name} å¹´ä»½ï¼ˆ1-${era.max}ï¼‰`;
          return;
        }

        year = era.start + eraYear - 1;
      }

      if (!year || isNaN(year) || year < 1) {
        document.getElementById("result").textContent = "è«‹è¼¸å…¥æœ‰æ•ˆå¹´ä»½ã€‚";
        return;
      }

      const roc = year - 1911;
      const rocStr = roc >= 1 ? `æ°‘åœ‹ ${roc} å¹´` : "ï¼ˆå°šæœªå»ºåœ‹ï¼‰";
      const zodiacSign = zodiac[(year - 4) % 12];

      let jpName = "ï¼ˆç„¡å°æ‡‰ï¼‰";
      for (const era of japaneseEraMap) {
        if (year >= era.start) {
          const num = year - era.start + 1;
          if (num <= era.max) {
            jpName = `${era.name}${num} å¹´`;
            break;
          }
        }
      }

      let lionelNote = (year === 2013) ? " [Lionelå‡ºç”Ÿå¹´ !!!]" : "";

      document.getElementById("result").innerHTML = `
        âœ… è¥¿å…ƒï¼š${year} å¹´${lionelNote}<br>
        ğŸ‡¹ğŸ‡¼ ${rocStr}<br>
        ğŸ‡¯ğŸ‡µ æ—¥æœ¬å’Œæ›†ï¼š${jpName}<br>
        ğŸ¾ åäºŒç”Ÿè‚–ï¼š${zodiacSign}
      `;
    }
  </script>
</body>
</html>
